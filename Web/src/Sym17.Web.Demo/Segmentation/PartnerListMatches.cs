using Serilog;
using Sitecore.Framework.Rules;
using Sitecore.XConnect;
using Sitecore.XConnect.Client;

using Sym17.Web.Models.Facets.Contact;
using System;

namespace Sym17.Web.Demo.Segmentation
{
    public class PartnerListMatches : ICondition, IMappableRuleEntity
    {
        public bool Evaluate(IRuleExecutionContext context)
        {
            var contact = RuleExecutionContextExtensions.Fact<Contact>(context);

            XConnectClient client = XConnectClientReference.GetClient();

            Contact existingContact = client.Get<Contact>(contact, new ContactExpandOptions(CvPersonFacet.DefaultFacetKey));

            CvPersonFacet personFacet = existingContact.GetFacet<CvPersonFacet>(CvPersonFacet.DefaultFacetKey);

            if (string.IsNullOrEmpty(personFacet?.Company))
            {
                return false;
            }

            //string[] partnersList = Partners.Split(';');

            //bool result = partnersList.Any(p => p.IndexOf(personFacet.Company, StringComparison.OrdinalIgnoreCase) > 0);

            bool result = Partners.IndexOf(personFacet.Company, StringComparison.OrdinalIgnoreCase) > 0;

            Log.Information("PartnerListMatches result ==  " + (result).ToString());

            return result;
        }

        private const string Partners = @"1508 A/S;22squared Inc;24HR;2nd Factory;3bits;3chillies;3S Intersoft;4 Roads;4impact Group;5 Limes;7Summits;7Summits;A Hundred Answers Inc;ABSI;Absolunet;Acando;Accenture;AccessECM;Aceik;Actis Wunderman;Actum;Adcetera;Addisolv;Addition A/S;Adelphi Digital Consulting Group;Adelphi Digital Consulting Group;Adept Group Limited;Advaiya;Advancya;Agaso LLC;agencyQ;Agenda;Agic Techology;AgileThought;AJi Software;AKQA;Alan Systems;Allen & Gerritsen;ALLWIN Informatics;Alogient;Alpha Solutions;Alpha Solutions;Altitudo;Amaze;Ameex Technologies;Americaneaglecom Inc;Amplexor;APD;Apiqu;APOTAMOX;Appius;Aqueduct;AQuest;Arcadian Digital;Archer Group;archer>malmo;Arke Systems;Arrow Consulting & Design;Ascedia;Aspenware;Atcom;ATO interactive GmbH;ATOM;Atos;Atos Switzerland;AuroSys Solutions;Avanade;Avancix;Avantia;Avastone Technologies LLC;Avaus Marketing Innovations;Aviva Solutions;Avtex;Aware Web Solutions;Axendo;Axis41;Ayantek;Bates Pan Gulf;Bayleaf Software Inc;BBS;Beaconfire Red;Bekk Consulting;Belong Interactive;BestSoft Consulting;Beyondsoft Consulting Inc;Big Group;Binary Republik India;Bit by Bit;bit10;BitCompute;Blast Radius;Blast Radius;Blend Interactive;Bleum;Blitz;Blue Car Technologies;Blue Fountain Media;Blue Infinity;Blue Rooster;Blueleaf;BlueMetal Architects;BlueModus;Blueprint Partners;Bluetube;BOLD;Bonfire;Boondoggle;BORN;Boston Interactive;Bouvet;Box UK;BrainJocks;Branded3;Bravo!;Bray Leino Yucca;Brightfind;Brimit;Brimit;BRUNNER;BTC AG;Building Blocks;Bullseye;Bullseye New Zealand;bv02;Byte Information Technology;Cabana;Caesar Groep;Calavista Software;Candyspace;CapTech;Cardinal Solutions;Castelis;Catalyst Fire;CDS;Cedar Communications Ltd (Cedar DCX);Cegeka;Cegeka;Celerity;Centric;CGN;CHE Proximity;Chemistry Communications;CIBER;CIBER;ClearPeople Ltd;ClerksWell;CloudRaker;Cluster Reply;CMS Source;Co3;Cocomore AG;code computerlove;Codehouse;Codehouse;Codehouse;Coders Center;Cognifide;Cognifide;Cognizant Technology Solutions;Cognizant Technology Solutions;Cohaesus;Cold Banana Studio;Colours;Competitive Computing (C2);comspace GmbH & Co KG;Conclusion Digital;Connective DX;Consid;Conversionista;Corbus LLC;Coria;Cornerstone Consulting Inc;Corporate Web Services;Cramer;Create Digital;CSI Media;C-Tilsted;Cucumber;Cybage Software;Cyber Group;Cyberwoven;Cygnet Infotech;Cylogy Inc;Datacom;Datacom;Datamatics;DearNova;DECADE;Deepend;Defakto;defimedia;DEG Digital;Degree 53;Delaware Consulting;Delaware Consulting;Delaware Consulting;Delaware Consulting;Delete;Deloitte Digital ANZ;Deloitte Portugal;Delphic Digital;Dentsu Digital;Diamantea;Digital Wave;Digitaria;DigitasLBi UAE;DIS/PLAY;Diversus;Dog Digital;Dog Digital;Dot Zone;Dreamtek;Droxic;DT;Durable Digital;Dwarf;e3 Media;East;E-Cubed Media Synthesis;ecxio;ecxio;edicos Group;Eduserv;edynamic;Eksponent;Elbgoods;Element 78;Emakina;Empired;Endava;Endava;Endava;Engagency;Engine Room Technology;Enjoy Digital;Enlighten Designs;Enthink;Envivent;EPAM;EPAM;EPAM;Epsilon;Epsilon;Equator;ESi Technology;Espire Infolabs;Espire Infolabs;Essense Partners;Estate Internet;Everis;Evident;evodion IT;Evolvit;EVRY;EX Squared;Exceed IT Services;EXLRT;Extractable;Falafel Software;Falcon-Software Company Inc;Falls Digital;Fast Web Media;FCV Interactive;Ferrara;FFW;fifty50;Finity Solutions;First Derivatives Canada;Fishtank Consulting;FIWE;fixer;Flip – Powered by PublicisSapient;Forte Systems;Fortuitas;Friday;Fujitsu;Fusion;GDC IT Solutions;GeekHive;Gengu – Digital Agency;Genuine;Get Started;GFI;Global Infonet Inc;Global Technology Integrator Limited (GTI);Globant;GM Servizi;Graph;Green River Media;Green Team;GreenwoodCampbell;Grey Ghost Studio;Gruden;Gruden;GSoft;Guerrilla Digital;Habanero Consulting Group;Hanson Dodge Creative;Hardhat Digital;HCL Technologies;HCL Technologies;Healthware;HeathWallace;Hedgehog;Hedgehog;Hero Digital;Hi Mum! Said Dad;Hitachi Consulting;Hitachi Consulting;Hive Media;Holler Australia;Horizontal Integration;Huge;Hugo & Cat;Hypermedia Isobar;i3 Digital;icemedia;ICF Olson;Icon Inc;I-D Media AG;IE;Igentics;Ignia;iHorizons;ilionx;ILLUMI;Imaginuity;imc²;iMedia inc;Immeo;IMO Agency;IMPACT A/S;IN2MEDIA;IN2MEDIA;INDECA;Indivirtual Dubai;Indusa;Infinity Group;Inflection Point Systems;Infocentric;Infosys;Infosys;Infusion;INIT;INIT [ Austria Germany India Switzerland ];Inmento Solutions;Innis Maggiore;Innofactor;InRiver;Integrated Digital Technologies;Intelledox;Intellicom;Intellinet;Interactive Strategies;Internet Projekt;intive;Intouch Solutions;Investis;Iquality;Iron Orchard;Isobar Australia;Isobar Hong Kong;Isobar United States;Itera;ItumX;ITWorx;ITX Corp;Ivatama Teknologi;JairoSolutions;Jaywing Limited;JBS;JOPS;K2 Internet;Kabel;Kagool;Karbyn;KBQuest Group Inc;Kiandra;Kickbyte;Kiefer Consulting;Klean;Kloud Solutions;KMP Digitata;Knowit;Knowit;Kodexe;Konrad Group;KPIT;KPS;Kraftvaerk;Kruso;KSA&D;kuehlhaus AG;Lab;Lake Solutions;LaneTerralever;Laughlin Constable;Layer One Media;LECOATI;legrand;Leighton Ltd;Lightmaker;Linakis Digital;LineZero Development;LINK Development;Liquid Interactive;Liquid Interactive;LiquidHub;Loftwork;Loud and Clear;Lucid Circus;Lukkien;Luxoft;LYZON;Macaw;Mad*Pow;Magnetix;MakoLab;Mammoth Media;Mando;Manifest;Mannai;Mapleton Hill Media;Marcus Thomas LLC;Mavention;Mayfly Media;McCann Birmingham;MedTouch;MethodFactory;mindSHIFT Technologies;Mindtree;Mirabeau;Mirum Agency;Mirum Hong Kong;Mirum Jordan;Mirum UAE;Mitrais;Modern Climate;Mogul;Momentum Digital Solutions;Moxie;Mphasis;MRM;MullenLowe Profero;Nagarro;Namics AG;NEC Australia;Nemetos;Netcel;Netcompany;Netlab;Netrix;netzkern AG;nevelingnet GmbH;New Angle Media;New Media Labs;Newpath;Nexio;Nextscape;Ngoar;NIIT Technologies Ltd;Nish Tech;Niteco Group Ltd;nonlinear digital;Novicell;NOW Digital;NTT DATA;NTT DATA China;Nurun;Nurun IT Consulting Services;Oakton;Object Consulting;Oevermann;Ogilvy;Ogilvy Asia;OLSON;Omegapoint;Omnia;One North Interactive;OneClick Limited;Optiem;opus:creative;Orange Bus;ORM London;OSF Global Services;Oshyn;Ovrlod;Oxygen Software;Pancentric;Panlogic Ltd;Pantha Corporation;Para Solutions;Paragon Consulting;Pariveda Solutions;Partech;PennyWise Solutions;Pentia;Perficient;Phases;Photon;PING Works;PixelMEDIA;Plus Consulting;Poort80;Portalgrup;Portalia;POSSIBLE;Pragmasoft;Precedent;Primacy;Prime Holding;PrimeIT;Priocept;ProActive;Prodigious;Productive Edge;Profound;Project House;Protiviti;Prototype;Proximity BBDO;PT Mitra Integrasi Informatika;PT Ebiz Cipta Solusi;Purestone;PwCs Digital Services;Pyramid;Qite;Quba;Questus;Quisitive;R/GA;R2integrated;Radley Yeldar;Ramp Technology Group;Ratio;Ray Business Technologies;Razorfish;RBA;RDA Corporation;Reading Room;Redhotminute;Redhotminute;Redweb;reverb360;Revium ANZ;Rightpoint;Rippleffect;RIX;Rosetta;Roundedcube;Rufus Leonard;RXP Services;Sagepath;Sagittarius;SapientNitro;Searchlight Group;Sequence;ServerLogic;ServerSide Inc;Shanghai Connext Information Technology Co Ltd;SharpTec LLC;Shout Digital;Shree Partners;Sid Lee;Sidewalk;Sigma IT Consulting;SigmaConsulting;Sii;SII Belgium;Siili;SILK;SilverTech Inc;Simple [A];SingleStone;Siteworx;Sixth Frame;Skybridge Infotech;Slalom Consulting;Slicedbread;SmartOSC Corporation;SMITH;SMS Management and Technology;SMT Software;SoftBankTechnology;SoftwareHut;Solpac;Sopra Steria;Speedwell;Splash Interactive;Square Root Interactive;SRA Information Technology;stackArmor;StangaOne1;StartJG;Stendahls;Stonebridge Systems;Sullivan Branding;SUNECO;Supersonic;Sutrix Group;Suyati Technologies;Swissworx;Switch;SymSoft Solutions;Synechron Technologies LLC;Systems Technology Group Inc (STG);T4G;Tahoe Partners;TamTam;Tanasuk Technologies;Tangent;Tata Consultancy Services;T-bone Productions;TBSCG;TCSC;TEC Services Consulting Inc;Tech Mahindra;TechAspect;TechGuilds;Techromix Solutions;Tekcent;Tekcent Vietnam;TEKsystems Global Services;Th_nk;The Berndt Group;The BIO Agency;The Inside Corner;The Nerdery;the peak lab;The Reference;The Reference;The Valley;The White Agency;theFactore;Think Brownstone;Think Digital;ThoughtMatrix;Three Point Turn;Thrillworks Inc;thunder tech;Tibe net;Timeintermedia;TMW;Traffic;transcosmos;Translationscom;Tribal Worldwide London;TRIMM;Triple IT;Trivident;True Clarity;True Digital;twentysix;Twins;Twist Image;UDG United Digital Group;Umwelt;Unic AG;Unicorn Systems;Unified Solutions;Unipro;UNIT4;Uselab;Valtech [France USA];Valtech [Great Britain Switzerland];Valtech [Netherlands Denmark];Vanick Digital;VASSIT;VCCP;Vega IT Sourcing;Velir;Velocity Werks;VeloWerks;Velrada;Veracity;Veripark;Verndale;Versusmind;Vertex;Vertic;Vertica;Virtual Affairs;Virtual Affairs;Virtusa;Visionet Systems;VIU;VML;Wakefly Inc;Web Design Magic;Web Professional House Pte Ltd (WPH);Web Spiders Ltd;Web Synergies (S) Pte Ltd;Webbyrån Petra;Webcuisine;Gesellschaft für neue Medien mbH;Websparks;Wedia;Welcom Digital;West Monroe Partners;WEtap Media;White Labelled;White Page Creation;Wijs;Winning Strategies ITS;Winvision;Wipro Ltd;Wire Stone;Wishbone Digital Group;Wunderman;XCentium;Xpand IT;Xtremax;Yen Digital;Yoyo Design;zedIT;ZeroSeven;";
    }
}